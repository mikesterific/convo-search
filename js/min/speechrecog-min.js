function updateCountry(){for(var n=select_dialect.options.length-1;n>=0;n--)select_dialect.remove(n);for(var e=langs[select_language.selectedIndex],n=1;n<e.length;n++)select_dialect.options.add(new Option(e[n][1],e[n][0]));select_dialect.style.visibility=1==e[1].length?"hidden":"visible"}function upgrade(){start_button.style.visibility="hidden",showInfo("info_upgrade")}function linebreak(n){return n.replace(two_line,"<p></p>").replace(one_line,"<br>")}function capitalize(n){return n.replace(first_char,function(n){return n.toUpperCase()})}function createEmail(){var n=final_transcript.indexOf("\n");(0>n||n>=80)&&(n=40+final_transcript.substring(40).indexOf(" "));var e=encodeURI(final_transcript.substring(0,n)),i=encodeURI(final_transcript.substring(n+1));window.location.href="mailto:?subject="+e+"&body="+i}function copyButton(){recognizing&&(recognizing=!1,recognition.stop()),copy_info.style.display="inline-block",showInfo("")}function emailButton(){recognizing?(create_email=!0,recognizing=!1,recognition.stop()):createEmail(),email_button.style.display="none",email_info.style.display="inline-block",showInfo("")}function startButton(n){return recognizing?void recognition.stop():(final_transcript="",recognition.lang=select_dialect.value,recognition.start(),ignore_onend=!1,final_span.innerHTML="",interim_span.innerHTML="",start_img.src="images/mic-slash.gif",showInfo("info_allow"),showButtons("none"),void(start_timestamp=n.timeStamp))}function showInfo(n){if(n){for(var e=info.firstChild;e;e=e.nextSibling)e.style&&(e.style.display=e.id==n?"inline":"none");info.style.visibility="visible"}else info.style.visibility="hidden"}function showButtons(n){n!=current_style&&(current_style=n,email_button.style.display=n,copy_info.style.display="none",email_info.style.display="none")}for(var langs=[["Afrikaans",["af-ZA"]],["Bahasa Indonesia",["id-ID"]],["Bahasa Melayu",["ms-MY"]],["Català",["ca-ES"]],["Čeština",["cs-CZ"]],["Deutsch",["de-DE"]],["English",["en-AU","Australia"],["en-CA","Canada"],["en-IN","India"],["en-NZ","New Zealand"],["en-ZA","South Africa"],["en-GB","United Kingdom"],["en-US","United States"]],["Español",["es-AR","Argentina"],["es-BO","Bolivia"],["es-CL","Chile"],["es-CO","Colombia"],["es-CR","Costa Rica"],["es-EC","Ecuador"],["es-SV","El Salvador"],["es-ES","España"],["es-US","Estados Unidos"],["es-GT","Guatemala"],["es-HN","Honduras"],["es-MX","México"],["es-NI","Nicaragua"],["es-PA","Panamá"],["es-PY","Paraguay"],["es-PE","Perú"],["es-PR","Puerto Rico"],["es-DO","República Dominicana"],["es-UY","Uruguay"],["es-VE","Venezuela"]],["Euskara",["eu-ES"]],["Français",["fr-FR"]],["Galego",["gl-ES"]],["Hrvatski",["hr_HR"]],["IsiZulu",["zu-ZA"]],["Íslenska",["is-IS"]],["Italiano",["it-IT","Italia"],["it-CH","Svizzera"]],["Magyar",["hu-HU"]],["Nederlands",["nl-NL"]],["Norsk bokmål",["nb-NO"]],["Polski",["pl-PL"]],["Português",["pt-BR","Brasil"],["pt-PT","Portugal"]],["Română",["ro-RO"]],["Slovenčina",["sk-SK"]],["Suomi",["fi-FI"]],["Svenska",["sv-SE"]],["Türkçe",["tr-TR"]],["български",["bg-BG"]],["Pусский",["ru-RU"]],["Српски",["sr-RS"]],["한국어",["ko-KR"]],["中文",["cmn-Hans-CN","普通话 (中国大陆)"],["cmn-Hans-HK","普通话 (香港)"],["cmn-Hant-TW","中文 (台灣)"],["yue-Hant-HK","粵語 (香港)"]],["日本語",["ja-JP"]],["Lingua latīna",["la"]]],i=0;i<langs.length;i++)select_language.options[i]=new Option(langs[i][0],i);select_language.selectedIndex=6,updateCountry(),select_dialect.selectedIndex=6,showInfo("info_start");var create_email=!1,final_transcript="",recognizing=!1,ignore_onend,start_timestamp;if("webkitSpeechRecognition"in window){start_button.style.display="inline-block";var recognition=new webkitSpeechRecognition;recognition.continuous=!0,recognition.interimResults=!0,recognition.onstart=function(){recognizing=!0,showInfo("info_speak_now"),start_img.src="images/mic-animate.gif"},recognition.onerror=function(n){"no-speech"==n.error&&(start_img.src="images/mic.gif",showInfo("info_no_speech"),ignore_onend=!0),"audio-capture"==n.error&&(start_img.src="images/mic.gif",showInfo("info_no_microphone"),ignore_onend=!0),"not-allowed"==n.error&&(showInfo(n.timeStamp-start_timestamp<100?"info_blocked":"info_denied"),ignore_onend=!0)},recognition.onend=function(){if(recognizing=!1,!ignore_onend){if(start_img.src="images/mic.gif",!final_transcript)return void showInfo("info_start");if(showInfo(""),window.getSelection){window.getSelection().removeAllRanges();var n=document.createRange();n.selectNode(document.getElementById("final_span")),window.getSelection().addRange(n)}create_email&&(create_email=!1,createEmail())}},recognition.onresult=function(n){for(var e="",i=n.resultIndex;i<n.results.length;++i)n.results[i].isFinal?final_transcript+=n.results[i][0].transcript:e+=n.results[i][0].transcript;final_transcript=capitalize(final_transcript),final_span.innerHTML=linebreak(final_transcript),interim_span.innerHTML=linebreak(e),(final_transcript||e)&&showButtons("inline-block")}}else upgrade();var two_line=/\n\n/g,one_line=/\n/g,first_char=/\S/,current_style;